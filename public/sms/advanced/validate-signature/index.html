<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.63.2" />
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Validate Inbound SMS :: Vonage Workshop</title>

    
    <link href="/css/nucleus.css?1584471998" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1584471998" rel="stylesheet">
    <link href="/css/hybrid.css?1584471998" rel="stylesheet">
    <link href="/css/featherlight.min.css?1584471998" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1584471998" rel="stylesheet">
    <link href="/css/auto-complete.css?1584471998" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1584471998" rel="stylesheet">
    <link href="/css/theme.css?1584471998" rel="stylesheet">
    <link href="/css/hugo-theme.css?1584471998" rel="stylesheet">
    
      <link href="/css/theme-blue.css?1584471998" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1584471998"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/sms/advanced/validate-signature/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <img src="/images/vonagelogo-secondary-black.png"></img>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1584471998"></script>
<script type="text/javascript" src="/js/auto-complete.js?1584471998"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/vonage-workshop.nexmodev.com\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1584471998"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/basic-concepts/" title="Basic Concepts" class="dd-item 
        
        
        
        ">
      <a href="/basic-concepts/">
          Basic Concepts
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/basic-concepts/nexmo-dashboard/" title="Nexmo Dashboard" class="dd-item 
        
        
        
        ">
      <a href="/basic-concepts/nexmo-dashboard/">
          Nexmo Dashboard
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/basic-concepts/nexmo-cli/" title="Nexmo CLI" class="dd-item 
        
        
        
        ">
      <a href="/basic-concepts/nexmo-cli/">
          Nexmo CLI
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/basic-concepts/ngrok/" title="ngrok" class="dd-item 
        
        
        
        ">
      <a href="/basic-concepts/ngrok/">
          ngrok
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/basic-concepts/number-format/" title="Formatting Numbers" class="dd-item 
        
        
        
        ">
      <a href="/basic-concepts/number-format/">
          Formatting Numbers
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/sms/" title="SMS API" class="dd-item 
        parent
        
        
        ">
      <a href="/sms/">
          SMS API
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/sms/send-sms/" title="Send an SMS" class="dd-item 
        
        
        
        ">
      <a href="/sms/send-sms/">
          Send an SMS
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/sms/receive-sms/" title="Receive an SMS" class="dd-item 
        
        
        
        ">
      <a href="/sms/receive-sms/">
          Receive an SMS
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/sms/receive-dlr/" title="Get a Delivery Receipt" class="dd-item 
        
        
        
        ">
      <a href="/sms/receive-dlr/">
          Get a Delivery Receipt
          
      </a>
      
              
    </li>
  
 

            
          
             
            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/verify/" title="Verify API" class="dd-item 
        
        
        
        ">
      <a href="/verify/">
          Verify API
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/verify/create-verify-request/" title="Create Verify Request" class="dd-item 
        
        
        
        ">
      <a href="/verify/create-verify-request/">
          Create Verify Request
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/verify/check-verify-request/" title="Check Verify Request" class="dd-item 
        
        
        
        ">
      <a href="/verify/check-verify-request/">
          Check Verify Request
          
      </a>
      
              
    </li>
  
 

            
          
             
            
          
             
            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/voice/" title="Voice API" class="dd-item 
        
        
        
        ">
      <a href="/voice/">
          Voice API
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/voice/first-call/" title="Make Your First Call" class="dd-item 
        
        
        
        ">
      <a href="/voice/first-call/">
          Make Your First Call
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/voice/answer-call/" title="Call Your Application" class="dd-item 
        
        
        
        ">
      <a href="/voice/answer-call/">
          Call Your Application
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/voice/user-input/" title="Interact with your user" class="dd-item 
        
        
        
        ">
      <a href="/voice/user-input/">
          Interact with your user
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/voice/build-ivr/" title="Building an IVR" class="dd-item 
        
        
        
        ">
      <a href="/voice/build-ivr/">
          Building an IVR
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/voice/record-a-call/" title="Record a Call" class="dd-item 
        
        
        
        ">
      <a href="/voice/record-a-call/">
          Record a Call
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/voice/voice-proxy/" title="Voice Proxying" class="dd-item 
        
        
        
        ">
      <a href="/voice/voice-proxy/">
          Voice Proxying
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/messages/" title="Messages and Dispatch" class="dd-item 
        
        
        
        ">
      <a href="/messages/">
          Messages and Dispatch
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Welcome</a> > <a href='/sms/'>SMS API</a> > <a href='/sms/advanced/'>Advanced</a> > Validate Inbound SMS
          
         
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#validate-with-a-server-sdk">Validate With a Server SDK</a>
      <ul>
        <li><a href="#write-the-code">Write the Code</a></li>
      </ul>
    </li>
    <li><a href="#if-you-needed-to-diy">If You Needed to DIY</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Validate Inbound SMS
            </h1>
          

        




	<h2 id="overview">Overview</h2>
<p>If we were to turn on SMS Signing with our Nexmo Accounts you will, when you receive an inbound SMS webhook, receive a &lsquo;sig&rsquo; parameter as part of it. This signature was generated by Nexmo and you can validate it with your signature secret, allowing you to verify that the origin of the message was in fact Nexmo.</p>
<blockquote>
<p>NOTE this feature must be enabled by <a href="mailto:support@nexmo.com">support@nexmo.com</a></p>
</blockquote>
<h2 id="validate-with-a-server-sdk">Validate With a Server SDK</h2>
<p>The server SDK&rsquo;s support signature verification so verifying the signature is as simple as pulling the parameters out of the request and comparing them against the sig parameter.</p>
<h3 id="write-the-code">Write the Code</h3>
<p>Create a file called &lsquo;receive-signed-sms.js&rsquo; and add the following to it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>)()
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">bodyParser</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;body-parser&#39;</span>)
<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">Nexmo</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;nexmo&#39;</span>)

<span style="color:#a6e22e">app</span>
  .<span style="color:#a6e22e">route</span>(<span style="color:#e6db74">&#39;/webhooks/inbound-sms&#39;</span>)
  .<span style="color:#a6e22e">get</span>(<span style="color:#a6e22e">handleInboundSms</span>)
  .<span style="color:#a6e22e">post</span>(<span style="color:#a6e22e">handleInboundSms</span>)

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleInboundSms</span>(<span style="color:#a6e22e">request</span>, <span style="color:#a6e22e">response</span>) {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">params</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">assign</span>(<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">query</span>, <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">body</span>)

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">NEXMO_API_SIGNATURE_SECRET</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">NEXMO_API_SIGNATURE_SECRET</span>
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">Nexmo</span>.<span style="color:#a6e22e">generateSignature</span>(<span style="color:#e6db74">&#34;md5hash&#34;</span>, <span style="color:#a6e22e">NEXMO_API_SIGNATURE_SECRET</span>, <span style="color:#a6e22e">params</span>) <span style="color:#f92672">===</span> <span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">sig</span>) {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Valid signature&#34;</span>);
  } <span style="color:#66d9ef">else</span> {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Invalid signature&#34;</span>);
  }

  <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">204</span>).<span style="color:#a6e22e">send</span>()
}

<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">PORT</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">3000</span>)
</code></pre></div><p>With this - configure your account or number&rsquo;s inbound SMS webhook to point at this endpoint, then run:</p>
<p><code>NEXMO_API_SIGNATURE_SECRET=NEXMO_API_SIGNATURE_SECRET node receive-signed-sms.js</code></p>
<p>Now whenever you send an SMS to your number - you will receive a message in your terminal &lsquo;Valid signature&rsquo; indicating that the signature has been accepted.</p>
<p>If you were to send something with a bad signature to this endpoint via curl or postman, you would see the &lsquo;Invalid Signature&rsquo; message indicating that the signature was not validated.</p>
<h2 id="if-you-needed-to-diy">If You Needed to DIY</h2>
<p>To validate that the signature matches what the API should have sent you - you will take the the inbound message parameters - remove the sig from it, arrange it as you would for an outbound message (alphabetically, as a query string with an ampersand &lsquo;&amp;&rsquo; at the head of the string) - and Sign the Parameters with your Signature Secret.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/basic-concepts/number-format/" title="Formatting Numbers"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/sms/send-sms/" title="Send an SMS" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1584471998"></script>
    <script src="/js/perfect-scrollbar.min.js?1584471998"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1584471998"></script>
    <script src="/js/jquery.sticky.js?1584471998"></script>
    <script src="/js/featherlight.min.js?1584471998"></script>
    <script src="/js/highlight.pack.js?1584471998"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1584471998"></script>
    <script src="/js/learn.js?1584471998"></script>
    <script src="/js/hugo-learn.js?1584471998"></script>

    <link href="/mermaid/mermaid.css?1584471998" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1584471998"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
